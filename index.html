<!DOCTYPE html>
<html>
<head>
    <title>Logseq Bridge</title>
    <style>
        body { 
            background: #111; color: #eee; font-family: sans-serif; 
            display: flex; flex-direction: column; align-items: center; 
            justify-content: center; height: 100vh; margin: 0; 
        }
        button { 
            padding: 15px 30px; font-size: 1.2rem; cursor: pointer; 
            background: #2d81ff; color: white; border: none; border-radius: 8px; 
        }
        button:hover { background: #1a66cc; }
    </style>
<script>
    window.onload = function() {
        const params = new URLSearchParams(window.location.search);

        // 1. Get the data for Logseq
        const page = params.get('page') || 'TODAY';
        const content = params.get('content') || '';

        // 2. The "Detective" Logic: 
        // This looks for the value after 'caller=' in your URL
        const callerValue = params.get('caller') || ''; 
        const cleanNumber = callerValue.replace(/\D/g, '');

        // 3. Fire off to Logseq
        const logseqURI = `logseq://x-callback-url/quickCapture?page=${encodeURIComponent(page)}&content=${encodeURIComponent(content)}`;
        window.location.href = logseqURI;

        // 4. The 1881 "Pivot"
        setTimeout(() => {
            if (cleanNumber) {
                // Takes the real number and searches 1881
                window.location.href = `https://www.1881.no/?query=${cleanNumber}`;
            } else {
                window.location.href = "https://www.1881.no";
            }
        }, 800);
    };
</script>
</head>
<body>
    <h2>Sent to Logseq!</h2>
    <p>If this tab didn't "self-destruct," hit the button:</p>
    <button onclick="window.close()">Close Tab</button>
</body>
</html>
