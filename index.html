<!DOCTYPE html>
<html>
<head>
    <title>Logseq Bridge</title>
    <style>
        body { 
            background: #111; color: #eee; font-family: sans-serif; 
            display: flex; flex-direction: column; align-items: center; 
            justify-content: center; height: 100vh; margin: 0; 
        }
        button { 
            padding: 15px 30px; font-size: 1.2rem; cursor: pointer; 
            background: #2d81ff; color: white; border: none; border-radius: 8px; 
        }
        button:hover { background: #1a66cc; }
    </style>
<script>
    window.onload = function() {
        // 1. Grab everything: the ? part AND the # part
        const fullSearch = window.location.search;
        const fullHash = window.location.hash;
        
        // 2. Combine them so we don't "miss" anything
        // This treats everything after the ? as one big data pool
        const combinedParams = new URLSearchParams(fullSearch + fullHash.replace('#', '&'));

        const page = combinedParams.get('page') || 'Incoming';
        const title = combinedParams.get('title') || 'New Entry';
        const content = combinedParams.get('content') || '';

        // 3. Build the Logseq "handshake"
        const logseqURI = `logseq://x-callback-url/quickCapture?page=${encodeURIComponent(page)}&title=${encodeURIComponent(title)}&content=${encodeURIComponent(content)}`;

        // 4. Launch and "Vanish"
        window.location.href = logseqURI;
        
        setTimeout(() => {
            window.location.href = "about:blank";
        }, 500);
    };
</script>
</head>
<body>
    <h2>Sent to Logseq!</h2>
    <p>If this tab didn't "self-destruct," hit the button:</p>
    <button onclick="window.close()">Close Tab</button>
</body>
</html>
